{% extends "form.html" %}
{% load i18n %}
{% load tools %}
{% load magi_tags %}

{% block title %}
{% if form_name == 'preferences' %}
{% trans 'Customize' %}
{% elif form_name == 'addLink' %}
{{ add_link_sentence }}
{% elif form_name == 'changePassword' %}
{% trans 'Change your password' %}
{% elif form_name == 'emails' %}
{% trans 'Emails' %}
{% else %}
{% trans 'Settings' %}
{% endif %}
{% endblock %}

{% block beforeform %}
{% if form_name == 'addLink' and links|length %}
<h1 id="links" class="text-center padding50">{% trans 'Links' %}</h1>
<br>
<form class="container_form" action="#addLink">
  <table class="table table-main table-padded table-rounded">
    {% for link in links %}
    <tr id="link{{link.id}}">
      <td>
	{% include 'include/link.html' %}
      </td>
      <td class="text-right" width="200"><a href="#deleteLink" data-link-id="{{ link.id }}" class="btn btn-lg btn-danger">{{ delete_link_sentence }}</a></td>
    </tr>
    {% endfor %}
  </table>
</form>
{% endif %}
{% endblock %}

{% block beforefields %}
{% endblock %}

{% block belowform %}
{% if form_name == 'addLink' %}
<h1 id="avatar" class="text-center padding50">{% trans 'Avatar' %}</h1>
<br>
<form class="container_form">
  <div class="alert alert-info">{% trans 'To change your avatar, use Gravatar with the same email address.' %}</div>
  <div class="text-right">
    <a href="https://github.com/SchoolIdolTomodachi/SchoolIdolAPI/wiki/How-to-change-your-avatar%3F" target="_blank" class="btn btn-lg btn-link">{% trans 'F.A.Q.' %}</a>
    <a class="btn btn-lg btn-main" href="https://{{ LANGUAGE_CODE }}.gravatar.com/" target="_blank">{% trans 'Change Avatar' %}</a>
  </div>
</form>

<h1 id="accounts" class="text-center padding50">{% trans 'Accounts' %}</h1>
<br>
<form class="container_form">
  <table class="table">
    {% for account in accounts %}
    <tr>
      <td><h4>{{ account }}</h4></td>
      <td class="text-right"><a href="{{ account.edit_url }}" class="btn btn-lg btn-main">{{ account.edit_sentence }}</a></td>
    </tr>
    {% endfor %}
  </table>
  <div class="text-right">
    <a href="/user/{{ user.id }}/{{ user.username }}/" class="btn btn-lg btn-link">{% trans 'Back to my profile' %}</a>
    <a href="/accounts/add/" class="btn btn-lg btn-main"><i class="flaticon-add"></i> {{ add_account_sentence }}</a>
  </div>
</form>

{% if user.groups %}
<h1 id="groups" class="text-center padding50"><i class="flaticon-about"></i> Your groups</h1>
<br>
<form class="container_form">
  <div class="list-group">
    {% for group, details in user.preferences.groups_and_details.items %}
    <div class="list-group-item">
      <h4 class="list-group-item-heading">{{ details.translation }}</h4>
      <p class="list-group-item-text">
        <small class="text-muted">{{ details.description }}</small>
        {% if details.permissions %}
        <ul>
          {% for permission in details.verbose_permissions %}
          <li>{{ permission }}</li>
          {% endfor %}
          {% for permission in details.outside_permissions %}
          <li>{{ permission }}</li>
          {% endfor %}
        </ul>
        {% endif %}
      </p>
    </div>
    {% endfor %}
  </div>
</form>
{% endif %}
<br><br><br><br><br><br>
{% endif %}
{% endblock %}

{% block otherbuttons %}
<a href="/user/{{ user.id }}/{{ user.username }}/" class="btn btn-lg btn-link">{% trans 'Back to my profile' %}</a>
{% endblock %}

{% block submit %}
{% if form_name == 'addLink' %}
{{ add_link_sentence }}
{% else %}
{% trans 'Apply Changes' %}
{% endif %}
{% endblock %}
